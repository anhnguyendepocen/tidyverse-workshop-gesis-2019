---
title: 'Exercises Terminology - Solutions'
# title: 'Exercises Terminology'
author: 'Johannes Breuer, Stefan JÃ¼nger, Thomas Ebel'
date: 'Data Wrangling & Exploration with the Tidyverse in R, May 15-16, 2019'
output:
  unilur::tutorial_html_solution: default
  # unilur::tutorial_html: default
---
  
  ```{r knitr_init, echo=FALSE, cache=FALSE, include=FALSE}
# custom boxes
knitr::opts_template$set(clues = list(box.title = "Clues",
                                      box.body = list(fill = "#fff9dc", colour = "black"),
                                      box.header = list(fill = "#ffec8b", colour = "black"),
                                      box.icon = "fa-search",
                                      box.collapse = TRUE))
```

```{r klippy, echo=FALSE, include=TRUE}
klippy::klippy()
```

This is the very first exercise of this course. It's not too hard, its purpose is rather to get used to our exercise format - this HTML file, for instance - and more importantly, to get used to the `tidyverse` world.

Consequently, this exercise is really short and just let you play around with some pipes and tibbles. It's a mini-exercise!

First things first: To work with the 'tidyverse' we have to have access to its packages.

```{block, box.title = "1", box.body = list(fill = "white"), box.icon = "fa-star"}
Load the `tidyverse` library.
```

```{block, opts.label = "clues"}
If the `tidyverse` library has not been installed yet, you can install it with the command `install.packages("tidyverse")`.
```

```{r load_tidyverse_solution, solution = TRUE, message = FALSE}
if (!require(tidyverse)) install.packages("tidyverse")
library(tidyverse)
```

After successfully loading the `tidyverse` library we turn to the magic world of pipes. Remember, pipes are a convenient way to disentangle nested `R` functions and to write cleaner `R` code. First, have a look at the code in the following block:

```{r to_pipe, message=FALSE, results = "hide"}
mean(sqrt(as.numeric(read.csv2("../data/titanic/titanic.csv", sep = ",")$Fare)))
```

```{block, box.title = "2", box.body = list(fill = "white"), box.icon = "fa-star"}
What do you think is the command doing?
```

```{block, opts.label = "clues"}
It's always a good approach to start from the inner command to the outer ones.
```

```{block to_pipe_purpose_solution, solution = TRUE, message = FALSE}
1. The `titanic` data are imported with `read.csv2()`
2. Only the `Fare` variable is extracted using the `$`-sign
3. The variable is converted to the numeric format with `as.numeric()`
4. A square root transformation is applied with `sqrt()`
5. The mean is calculated with `mean()`
```

Using the commands in such a way is not very clear, isn't it? You have already learned that pipes provide an easy approach to navigate this issue.

```{block, box.title = "3", box.body = list(fill = "white"), box.icon = "fa-star"}
Create a nice pipe from this nested command.
```

```{block, opts.label = "clues"}
You can call individual columns of a piped object with `.$col_name`.
```

```{r to_pipe_solution, , solution = TRUE}
read.csv2("../data/titanic/titanic.csv", sep = ",") %>% 
  .$Fare %>% 
  as.numeric() %>% 
  sqrt() %>% 
  mean()
```

As we've learned, tidyverse is not all about pipes, it's about tidy data. The default data format to have access to tidy data in `tidyverse` is the `tibble` format. In the previous task, you have already imported the `titanic` data, but it's in the standard `data.frame` format.

```{block, box.title = "4", box.body = list(fill = "white"), box.icon = "fa-star"}
Load the `titanic` dataset and convert it immediatly to a `tibble`. 
```

```{block, opts.label = "clues"}
`base-R`'s `read.csv2()` is your friend. Also, you may want to do it all at once in one pipe.
```

```{r titanic_to_tibble_solution, solution = TRUE}
titanic_tibble <-
  read.csv2("../data/titanic/titanic.csv", sep = ",") %>% 
  as_tibble()
```

Now look at the following `data.frame`. It's been created with the standard `base-R` tools. tidyverse also provides a feature, the `tribble()` command, to create small data tables as tibbles from scratch.


```{r to_tribble, echo=FALSE, message=FALSE}
as.data.frame(
  cbind(
    day           = 1:5,
    amount_coffee = c(2, 5, 1, 8, 4),
    words_written = c(245, 691, 10, 2100, 490)
  )
)
```


```{block, box.title = "5", box.body = list(fill = "white"), box.icon = "fa-star"}
Use the `tribble()`-function to directly rebuild the data frame as a tibble.
```

```{block, opts.label = "clues"}
Remember defining new columns with a preceding `~`. 
```

```{r to_tribble_solution, solution = TRUE}
tribble(
  ~day,  ~amount_coffee,   ~words_written, 
  1,                 2,              245,
  2,                 5,              691,
  3,                 1,               10,
  4,                 8,             2100,
  5,                 4,              490
)
```



