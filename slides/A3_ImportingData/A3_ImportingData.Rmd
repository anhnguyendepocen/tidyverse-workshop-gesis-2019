---
title: "Importing Data"
# subtitle: "(according to Hadley Wickham/RStudio)"
author: "Johannes Breuer<br />Thomas Ebel<br />Stefan MÃ¼ller"
date: "2019-05-15"
location: "GESIS, Mannheim, Germany"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: ["default", "robot-fonts", "../footer-header.css", "../mycss.css"]
    nature:
      highlightStyle: "github"
      highlightLines: true
      countIncrementalSlides: false
---
layout: true

```{r setup, include = FALSE}
packages_to_load <- c("knitr", "rmarkdown", "tidyverse", "readr", "readxl",
                      "haven")

for (i in packages_to_load) {
  if (!require(i, character.only = TRUE)) {
    install.packages(i)
  } else {
    library(i, character.only = TRUE)
  }
}

rm(packages_to_load)

options(htmltools.dir.version = FALSE)

opts_chunk$set(echo = FALSE, fig.align = "center")
```

<div class="my-footer">
  <div style="float: left;"><span>`r gsub("<br />", " & ", gsub("<br /><br />|<a.+$", "", metadata$author))`</span></div>
  <div style="float: right;"><span>`r metadata$location`, `r metadata$date`</span></div>
  <div style="text-align: center;"><span>`r gsub(".+<br />", " ", metadata$title)`</span></div>
</div>

---
# Data, Data, Data

--
Thus far, we've already learned that data can be untidy.


--
This course is all about making them tidy again (...or maybe for the first time?).


--
There's one rather important prerequisite, however:


--
.center[We need data!]

---
<h2> Getting Data in the tidyverse </h2>

Whether we want to use our own data or that from others, we need to get data into R.

tidyverse provides some nice tools to do so:

- readr  (for 'flat' files, such as CSV)
- readxl (for excel spreadsheets)
- haven  (for statistical software files, such as SPSS, Stata, and SAS)

The difference to other tool is that tidyverse import functions already prepare the data for being 'tidyed': they are a tibbles

```{r out.width='15%', fig.align='center', fig.show='hold'}
knitr::include_graphics(c("readr.png", "readxl.png", "haven.png"))
```



.right[![](readr.png) ![](readxl.png) ![](haven.png)]

---
# A readr example: `read_csv()`
```{r readr_example, echo = TRUE}
mtcars <- 
  "mtcars.csv" %>% 
  readr_example() %>% 
  read_csv()
```

---
# A readr example: `read_csv()`
```{r readr_example:output, echo = TRUE}
mtcars
```


It's that easy.

---
# A readxl example: `read_excel()`
```{r readxl_example, echo = TRUE}
datasets <- 
  "datasets.xlsx" %>% 
  readxl_example() %>% 
  read_excel()
```

No output :-(

---
# A readxl example: `read_excel()`
```{r readxl_example_output, echo = TRUE}
datasets
```

Just iris?

---
# A readxl example: `read_excel()`
```{r readxl_example_sheets, echo = TRUE}
"datasets.xlsx" %>% 
  readxl_example() %>% 
  excel_sheets()
```


---
# A readxl example: `read_excel()`
```{r readxl_example_sheets_loading, echo = TRUE}
mtcars <- 
  "datasets.xlsx" %>% 
  readxl_example() %>% 
  read_excel(sheet = "mtcars")
mtcars
```

---
# A haven example: `read_stata()`
```{r read_stata_example, echo = TRUE}
mtcars <-
system.file("examples", "iris.dta", package = "haven") %>% 
  read_stata()
mtcars
```

---
# There's More
These were just some very first examples of applying functions from each package.

- readr
  - `read_csv()`
  - `read_tsv()`
  - `read_delim()`
  - `read_fwf()`
  - `read_table()`
  - `read_log()`
- haven
  - `read_sas()`
  - `read_spss()`
  - `read_stata()`

Not to mention all the helper files and options. For example, we can define the cells to read from an excel file by applying the option `range = "C1:E4"` in
`read_excel()`

---
# Exporting Data
Sometimes we also have to leave R and its tidy world.

- We share data with colleagues
- We wanna start where we left the next day
  - Particularly, when data tidying to a long time
  
For these purposes, we also have to need a way to export our data.

All tools presented also have designated functions for that.

---
# Example: CSV files

---
# Maybe More Relevant: Stata Files

---
# Additional Packages
The great benefit of tidyverse import functions is the import of the data as tibbles: the data are potentially more tidy.

Several other non-tidyverse packages provide similar benefits as they make use of this universal data format:
- sf (for geospatial data)
- ...

---
# Alternative Packages







