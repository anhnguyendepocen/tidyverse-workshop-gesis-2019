<!DOCTYPE html>
<html>
  <head>
    <title>Summary Statistics</title>
    <meta charset="utf-8">
    <meta name="author" content="Johannes Breuer Thomas Ebel Stefan Müller" />
    <meta name="date" content="2018-05-16" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
    <link rel="stylesheet" href="..\footer-header.css" type="text/css" />
    <link rel="stylesheet" href="..\mycss.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Summary Statistics
## First inspections - What can we tell about the data?
### Johannes Breuer<br />Thomas Ebel<br />Stefan Müller
### 2018-05-16

---

layout: true



&lt;div class="my-footer"&gt;
  &lt;div style="float: left;"&gt;&lt;span&gt;Johannes Breuer &amp; Thomas Ebel &amp; Stefan Müller&lt;/span&gt;&lt;/div&gt;
  &lt;div style="float: right;"&gt;&lt;span&gt;GESIS, Mannheim, Germany, 2018-05-16&lt;/span&gt;&lt;/div&gt;
  &lt;div style="text-align: center;"&gt;&lt;span&gt;Summary Statistics&lt;/span&gt;&lt;/div&gt;
&lt;/div&gt;

---


class: center, middle

&lt;h1&gt;Demystifing unknown knowns&lt;/h1&gt;
&lt;h2&gt;What do we know, what don't we know and why do we care?&lt;/h2&gt;

---

&lt;h2&gt;Untangling data is hard&lt;/h2&gt;
Humans looking at raw numbers have a really hard time at understanding them.  
For example, it's almost impossible to say which of those 2 vectors has more variance, or the lower mean, just by looking at them.


```
##  [1] 31 55 37 60 63 20 43 60 44 39
```

```
##  [1] 59 38 47 43 24 56 30 21 33 59
```

--


```r
options(pillar.sigfig = 5)
untangling %&gt;% summarize(mean_x = mean(x), mean_y = mean(y),
                         var_x = sd(x)^2, var_y = sd(y)^2)
```

```
## # A tibble: 1 x 4
##   mean_x mean_y  var_x  var_y
##    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1   45.2     41 199.96 199.56
```

In the real world, vectors are also too long to conveniently look at.

---

To make sense of data ... we need summarizing functions that produce singular values that give us an understanding of
* location (e.g. the mean),
* spread (e.g. standard deviation),
* shape of distribution (e.g. skewness) and
* relations between variables (e.g. correlation coefficients)

---

We assume everyone here knows the basics of summary statistics.  
So instead of repeating that let's see respective Tidyverse code.

--

Dataset is from gapminder.  

Income per person (fixed 2000 US$) for 275 countries for the years 1960-2011.

"Gross Domestic Product per capita in constant 2000 US$. The inflation but not the differences in the cost of living between countries has been taken into account."


```r
capita &lt;- readxl::read_excel(
  path = "../data/GDPpercapitaconstant2000US.xlsx", sheet = "Data",
  col_names = TRUE)
```
---

A first glimpse.

```
## Observations: 275
## Variables: 53
## $ country  &lt;chr&gt; "Abkhazia", "Afghanistan", "Akrotiri and Dhekelia", "...
## $ `1960.0` &lt;dbl&gt; NA, NA, NA, NA, 1280.3848, NA, NA, NA, NA, NA, 5251.8...
## $ `1961`   &lt;dbl&gt; NA, NA, NA, NA, 1085.4146, NA, NA, NA, NA, NA, 5448.3...
## $ `1962`   &lt;dbl&gt; NA, NA, NA, NA, 855.9480, NA, NA, NA, NA, NA, 5316.57...
## $ `1963`   &lt;dbl&gt; NA, NA, NA, NA, 1128.4158, NA, NA, NA, NA, NA, 4956.2...
## $ `1964`   &lt;dbl&gt; NA, NA, NA, NA, 1170.3239, NA, NA, NA, NA, NA, 5375.4...
## $ `1965`   &lt;dbl&gt; NA, NA, NA, NA, 1215.0158, NA, NA, NA, NA, NA, 5855.6...
## $ `1966`   &lt;dbl&gt; NA, NA, NA, NA, 1127.6143, NA, NA, NA, NA, NA, 5733.3...
## $ `1967`   &lt;dbl&gt; NA, NA, NA, NA, 1200.5582, NA, NA, NA, NA, NA, 5833.0...
## $ `1968`   &lt;dbl&gt; NA, NA, NA, NA, 1291.8640, NA, NA, NA, NA, NA, 6028.1...
## $ `1969`   &lt;dbl&gt; NA, NA, NA, NA, 1359.4910, NA, NA, NA, NA, NA, 6515.3...
## $ `1970`   &lt;dbl&gt; NA, NA, NA, NA, 1436.1298, NA, 18256.2701, NA, NA, NA...
## $ `1971`   &lt;dbl&gt; NA, NA, NA, NA, 1235.6638, NA, 18142.9851, NA, NA, NA...
## $ `1972`   &lt;dbl&gt; NA, NA, NA, NA, 1527.6464, NA, 18646.9449, NA, NA, NA...
## $ `1973`   &lt;dbl&gt; NA, NA, NA, NA, 1538.306, NA, 19135.297, NA, NA, NA, ...
## $ `1974`   &lt;dbl&gt; NA, NA, NA, NA, 1603.3496, NA, 19304.3735, NA, NA, NA...
## $ `1975`   &lt;dbl&gt; NA, NA, NA, NA, 1632.2960, NA, 18607.4095, NA, NA, NA...
## $ `1976`   &lt;dbl&gt; NA, NA, NA, NA, 1714.0701, NA, 18511.4011, NA, NA, NA...
## $ `1977`   &lt;dbl&gt; NA, NA, NA, NA, 1747.6651, NA, 18394.4620, NA, NA, 38...
## $ `1978`   &lt;dbl&gt; NA, NA, NA, NA, 1848.4375, NA, 18038.5998, NA, NA, 39...
## $ `1979`   &lt;dbl&gt; NA, NA, NA, NA, 1923.2906, NA, 17379.3280, NA, NA, 42...
## $ `1980`   &lt;dbl&gt; NA, NA, NA, 1060.6846, 1876.0756, NA, 17013.6985, NA,...
## $ `1981`   &lt;dbl&gt; NA, NA, NA, 1099.5127, 1869.6213, NA, 16169.0217, NA,...
## $ `1982`   &lt;dbl&gt; NA, NA, NA, 1110.5123, 1924.6141, NA, 15514.6576, NA,...
## $ `1983`   &lt;dbl&gt; NA, NA, NA, 1101.3357, 1963.3651, NA, 14976.5906, NA,...
## $ `1984`   &lt;dbl&gt; NA, NA, NA, 1065.2353, 2008.4722, NA, 14554.7628, NA,...
## $ `1985`   &lt;dbl&gt; NA, NA, NA, 1059.8657, 2020.0872, NA, 14354.9066, 362...
## $ `1986`   &lt;dbl&gt; NA, NA, NA, 1091.5606, 1969.7642, NA, 14444.4621, 362...
## $ `1987`   &lt;dbl&gt; NA, NA, NA, 1054.2478, 1902.0611, NA, 14983.6322, 381...
## $ `1988`   &lt;dbl&gt; NA, NA, NA, 1013.6290, 1833.1529, NA, 15517.4947, 392...
## $ `1989`   &lt;dbl&gt; NA, NA, NA, 1092.4746, 1864.7126, NA, 15947.4902, 384...
## $ `1990`   &lt;dbl&gt; NA, NA, NA, 977.7655, 1832.7434, NA, 16070.0658, 372....
## $ `1991`   &lt;dbl&gt; NA, NA, NA, 687.9919, 1766.6608, NA, 15813.1016, 357....
## $ `1992`   &lt;dbl&gt; NA, NA, NA, 643.2858, 1755.9737, NA, 15194.4592, 322....
## $ `1993`   &lt;dbl&gt; NA, NA, NA, 714.2414, 1680.3799, NA, 14318.1890, 234....
## $ `1994`   &lt;dbl&gt; NA, NA, NA, 784.5831, 1630.3815, NA, 14092.4241, 235....
## $ `1995`   &lt;dbl&gt; NA, NA, NA, 899.7829, 1660.0042, NA, 14125.5934, 251....
## $ `1996`   &lt;dbl&gt; NA, NA, NA, 990.6532, 1698.3338, NA, 14662.7364, 272....
## $ `1997`   &lt;dbl&gt; NA, NA, NA, 895.5610, 1690.2375, NA, 16071.6449, 286....
## $ `1998`   &lt;dbl&gt; NA, NA, NA, 1013.5143, 1750.6509, NA, 16755.2207, 297...
## $ `1999`   &lt;dbl&gt; NA, NA, NA, 1118.1715, 1781.1425, NA, 17513.1782, 298...
## $ `2000`   &lt;dbl&gt; NA, NA, NA, 1200.1374, 1794.4052, NA, 17539.4420, 298...
## $ `2001`   &lt;dbl&gt; NA, NA, NA, 1281.8428, 1814.4151, NA, 19085.3641, 297...
## $ `2002`   &lt;dbl&gt; NA, NA, NA, 1313.7227, 1871.9220, NA, 19430.0548, 329...
## $ `2003`   &lt;dbl&gt; NA, NA, NA, 1381.0408, 1971.5128, NA, 19834.6326, 328...
## $ `2004`   &lt;dbl&gt; NA, NA, NA, 1454.0229, 2043.1357, NA, 20254.3463, 353...
## $ `2005`   &lt;dbl&gt; NA, NA, NA, 1525.7236, 2115.1860, NA, 20737.9451, 404...
## $ `2006`   &lt;dbl&gt; NA, NA, NA, 1594.4951, 2124.9578, NA, 21595.3955, 473...
## $ `2007`   &lt;dbl&gt; NA, NA, NA, 1681.6139, 2155.4852, NA, 21495.8051, 562...
## $ `2008`   &lt;dbl&gt; NA, NA, NA, 1804.4194, 2173.7879, NA, 21943.3399, 622...
## $ `2009`   &lt;dbl&gt; NA, NA, NA, 1857.3529, 2192.7040, NA, NA, 619.8186, N...
## $ `2010`   &lt;dbl&gt; NA, NA, NA, 1915.4245, 2231.9802, NA, NA, 623.2453, N...
## $ `2011`   &lt;dbl&gt; NA, NA, NA, 1965.7072, 2255.2255, NA, NA, 629.9553, N...
```


---
Let's start by reducing the data to 3 countries and converting it to long format.

```r
capita %&gt;%
  rename(country = 1) %&gt;%
  filter(country %in% 
           c("Germany", "United Kingdom", "United States")) %&gt;%
  gather(-1, key = "year", value = "income") %&gt;%
  arrange(country, year) %&gt;%
  tail
```

```
## # A tibble: 6 x 3
##   country       year  income
##   &lt;chr&gt;         &lt;chr&gt;  &lt;dbl&gt;
## 1 United States 2006  38349.
## 2 United States 2007  38711.
## 3 United States 2008  38209.
## 4 United States 2009  36539.
## 5 United States 2010  37330.
## 6 United States 2011  37691.
```

--

Showing the tail because Germany has missings up to and including 1969.



---

&lt;h2&gt;Summary statistics&lt;/h2&gt;


```r
capita_long %&gt;%
  mutate(change = (income / lag(income) - 1) * 100) %&gt;%
  group_by(country) %&gt;%
  summarise(n = sum(!is.na(income)), 
            min_inc = min(income, na.rm = TRUE),
            max_inc = max(income, na.rm = TRUE), 
            diff = max_inc - min_inc, has_na = any(is.na(income)),
            max_change = max(change, na.rm = TRUE))
```

```
## # A tibble: 3 x 7
##   country            n min_inc max_inc   diff has_na max_change
##   &lt;chr&gt;          &lt;int&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;lgl&gt;       &lt;dbl&gt;
## 1 Germany           42  11895.  26207. 14311. TRUE       5.4002
## 2 United Kingdom    52  10025.  29771. 19746. FALSE      7.1064
## 3 United States     52  13723.  38711. 24988. FALSE      6.2707
```

'change' is change in percent to previous year

---


```r
capita_long %&gt;%
  mutate(change = (income / lag(income) - 1) * 100) %&gt;%
  filter(change &gt; 5) 
```

```
## # A tibble: 6 x 4
##   country        year  income change
##   &lt;chr&gt;          &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1 Germany        1976  14043. 5.4002
## 2 United Kingdom 1970  13042. 6.4929
## 3 United Kingdom 1973  14654. 7.1064
## 4 United States  1965  16277. 5.0781
## 5 United States  1966  17136. 5.2771
## 6 United States  1984  24554. 6.2707
```

.highlight[16277 + (16277*5.2771/100) ~= 17136]

--



```r
# group_by(country) %&gt;%  
# filter(change == max(change, na.rm = TRUE))  
```


With  the outcomment code above we could use 'group_by' to just see the year in which each country's GDP increased the strongest. Even if we do not care about (other) summary statistics at all.

---

&lt;h2&gt;But, beware: Summary statistics can also be misleading!&lt;/h2&gt;
![](img/pity_the_fool.jpg)

... who takes summary statistics as the complete picture", Mr. T?  
Well said!

---

Beautifully illustrated by the 'datasauRus' package, summary statistics can also mislead you about the structure of a dataset/variable.  

--

For example, with a (Pearson's) correlation coefficient between two variables close to 0 we often immediately think of a relation like this:

&lt;img src="B3_SummaryStatistics_files/figure-html/unnamed-chunk-11-1.png" style="display: block; margin: auto;" /&gt;

---

**But**, datasauRus proves to us that various different relations with the same summary statistics are possible.

This one here has **the same correlation coefficient (-0.06, Pearson's)**.
&lt;img src="B3_SummaryStatistics_files/figure-html/unnamed-chunk-12-1.png" style="display: block; margin: auto;" /&gt;
---

As does this one (again, -0.06):
&lt;img src="B3_SummaryStatistics_files/figure-html/unnamed-chunk-13-1.png" style="display: block; margin: auto;" /&gt;

---
In fact, all of these 13 datasets have the same means, standard deviations, and Pearson's correlation coefficients.
&lt;img src="B3_SummaryStatistics_files/figure-html/unnamed-chunk-14-1.png" style="display: block; margin: auto;" /&gt;

---

&lt;h4&gt;Let's prove that to ourselves!&lt;/h4&gt;

Here's how the data set looks like

```r
datasauRus::datasaurus_dozen %&gt;% glimpse()
```

```
## Observations: 1,846
## Variables: 3
## $ dataset &lt;chr&gt; "dino", "dino", "dino", "dino", "dino", "dino", "dino"...
## $ x       &lt;dbl&gt; 55.3846, 51.5385, 46.1538, 42.8205, 40.7692, 38.7179, ...
## $ y       &lt;dbl&gt; 97.1795, 96.0256, 94.4872, 91.4103, 88.3333, 84.8718, ...
```

```r
datasauRus::datasaurus_dozen %&gt;% select(dataset) %&gt;% table
```

```
## .
##       away   bullseye     circle       dino       dots    h_lines 
##        142        142        142        142        142        142 
## high_lines slant_down   slant_up       star    v_lines wide_lines 
##        142        142        142        142        142        142 
##    x_shape 
##        142
```

---
Proving that the points in the various datasets (e.g. dino, away) are not identical.


```r
x &lt;- c(1,2,3,4)
x2 &lt;- c(4,3,2,1)
identical(sort(x),sort(x2))
```

```
## [1] TRUE
```

```r
dino &lt;- datasauRus::datasaurus_dozen %&gt;%
  filter(dataset == "dino")
away &lt;- datasauRus::datasaurus_dozen %&gt;%
  filter(dataset == "away")

identical(sort(dino$x), sort(away$x))
```

```
## [1] FALSE
```

---

And here's the solution to compute the statistics

```r
datasauRus::datasaurus_dozen %&gt;% group_by(dataset) %&gt;%
  summarise(n = n(), mean_x = mean(x), mean_y = mean(y), 
            sd_x = sd(x), sd_y = sd(y),
            corr = cor(x, y, method = "pearson"))
```

```
## # A tibble: 13 x 7
##    dataset        n mean_x mean_y   sd_x   sd_y      corr
##    &lt;chr&gt;      &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;
##  1 away         142 54.266 47.835 16.770 26.940 -0.064128
##  2 bullseye     142 54.269 47.831 16.769 26.936 -0.068586
##  3 circle       142 54.267 47.838 16.760 26.930 -0.068343
##  4 dino         142 54.263 47.832 16.765 26.935 -0.064472
##  5 dots         142 54.260 47.840 16.768 26.930 -0.060341
##  6 h_lines      142 54.261 47.830 16.766 26.940 -0.061715
##  7 high_lines   142 54.269 47.835 16.767 26.940 -0.068504
##  8 slant_down   142 54.268 47.836 16.767 26.936 -0.068980
##  9 slant_up     142 54.266 47.831 16.769 26.939 -0.068609
## 10 star         142 54.267 47.840 16.769 26.930 -0.062961
## 11 v_lines      142 54.270 47.837 16.770 26.938 -0.069446
## 12 wide_lines   142 54.267 47.832 16.770 26.938 -0.066575
## 13 x_shape      142 54.260 47.840 16.770 26.930 -0.065583
```

---

---
class: center, middle

&lt;h2&gt; Thanks!&lt;/h2&gt;

Slides created via the R package [**xaringan**](https://github.com/yihui/xaringan).

The chakra comes from [remark.js](https://remarkjs.com), [**knitr**](http://yihui.name/knitr), and [R Markdown](https://rmarkdown.rstudio.com).
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script>
(function() {
  var i, text, code, codes = document.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
})();
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
